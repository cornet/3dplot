<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>3dplot: convert.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>convert.c</h1><div class="fragment"><pre>00001 <span class="comment">/* convert.c</span>
00002 <span class="comment"> *</span>
00003 <span class="comment"> */</span>
00004 
00005 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00006 <span class="preprocessor">#include &lt;math.h&gt;</span>
00007 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00008 <span class="preprocessor">#include &lt;string.h&gt;</span>
00009 
00010 <span class="preprocessor">#include "<a class="code" href="main_8h.html">main.h</a>"</span>
00011 <span class="preprocessor">#include "<a class="code" href="file_8h.html">file.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="convert_8h.html">convert.h</a>"</span>
00013 
00014 <span class="keyword">struct </span><a class="code" href="structdataset.html">dataset</a> *funcToPara(<span class="keyword">struct</span> <a class="code" href="structdataset.html">dataset</a> *ds)
00015 {
00016     <span class="keywordtype">double</span> *t; <span class="comment">/* Used to expand arrays */</span>
00017     <span class="keywordtype">int</span> i,j;
00018     
00019     t = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * ds-&gt;<a class="code" href="structdataset.html#o0">X</a> * ds-&gt;<a class="code" href="structdataset.html#o1">Y</a>);
00020     <span class="comment">/* x(s,t) - Repeat all the current x values T times */</span>
00021     <span class="keywordflow">for</span> (i=0; i &lt; ds-&gt;<a class="code" href="structdataset.html#o1">Y</a>; i++) {
00022         <span class="keywordflow">for</span> (j=0; j &lt; ds-&gt;<a class="code" href="structdataset.html#o0">X</a>; j++) {
00023             t[ds-&gt;<a class="code" href="structdataset.html#o1">Y</a> * i + j] = ds-&gt;<a class="code" href="structdataset.html#o2">x</a>[j];
00024         }
00025     }
00026     ds-&gt;<a class="code" href="structdataset.html#o2">x</a> = t;
00027     
00028     <span class="comment">/* y(s,t) - Repeat each y value S times */</span>
00029     <span class="keywordflow">for</span> (i=0; i &lt; ds-&gt;<a class="code" href="structdataset.html#o1">Y</a>; i++) {
00030         <span class="keywordflow">for</span>(j=0; j &lt; ds-&gt;<a class="code" href="structdataset.html#o0">X</a>; j++) {
00031             t[ds-&gt;<a class="code" href="structdataset.html#o0">X</a> * i + j] = ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i];
00032         }
00033     }
00034     ds-&gt;<a class="code" href="structdataset.html#o3">y</a> = t;
00035     
00036     <span class="keywordflow">return</span> ds;
00037 }
00038 
00039 <span class="keyword">struct </span><a class="code" href="structdataset.html">dataset</a> *kurvToPara(<span class="keyword">struct</span> <a class="code" href="structdataset.html">dataset</a> *ds)
00040 {
00041     <span class="keywordtype">double</span> *tx, *ty, *tz; <span class="comment">/* Used to expand arrays */</span>
00042     <span class="keywordtype">int</span> i;
00043     <span class="keywordtype">float</span> width; <span class="comment">/* Width of strip used */</span>
00044     <span class="comment">/* Angle of rotation from line connecting adjcent</span>
00045 <span class="comment">        points to horizontal - anticlockwise */</span>
00046     <span class="keywordtype">double</span> alpha;
00047         
00048     width = <a class="code" href="convert_8h.html#a0">STRIPWIDTH</a>;
00049     
00050     tx = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * ds-&gt;<a class="code" href="structdataset.html#o0">X</a> * 2);
00051     ty = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * ds-&gt;<a class="code" href="structdataset.html#o0">X</a> * 2);
00052     tz = malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) * ds-&gt;<a class="code" href="structdataset.html#o0">X</a> * 2);
00053     
00054     <span class="comment">/* x(s,t) points of one side of strip */</span>
00055     <span class="keywordflow">for</span> (i=0; i &lt; ds-&gt;<a class="code" href="structdataset.html#o0">X</a> - 1; i++) {
00056         alpha = atan( (ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i + 1] - ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i]) /
00057                       (ds-&gt;<a class="code" href="structdataset.html#o2">x</a>[i + 1] - ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i]) );
00058         tx[i] = ds-&gt;<a class="code" href="structdataset.html#o2">x</a>[i] - (width/2) * sin(alpha);
00059         tx[i + ds-&gt;<a class="code" href="structdataset.html#o0">X</a>] = ds-&gt;<a class="code" href="structdataset.html#o2">x</a>[i] + (width/2) * sin(alpha);
00060         ty[i] = ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i] + (width/2) * cos(alpha);
00061         ty[i + ds-&gt;<a class="code" href="structdataset.html#o0">X</a>] = ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i] + (width/2) * cos(alpha);
00062         tz[i] = ds-&gt;<a class="code" href="structdataset.html#o4">z</a>[i];
00063         tz[i + ds-&gt;<a class="code" href="structdataset.html#o0">X</a>] = ds-&gt;<a class="code" href="structdataset.html#o4">z</a>[i + 1];
00064         
00065         <span class="comment">/* If on penultmate point then need to calculate final points */</span>
00066         <span class="keywordflow">if</span> ( i == ds-&gt;<a class="code" href="structdataset.html#o0">X</a> - 2 ) {
00067             tx[i + 1] = ds-&gt;<a class="code" href="structdataset.html#o2">x</a>[i + 1] - (width/2) * sin(alpha);
00068             tx[i + ds-&gt;<a class="code" href="structdataset.html#o0">X</a> + 1] = ds-&gt;<a class="code" href="structdataset.html#o2">x</a>[i + 1] + (width/2) * sin(alpha);
00069             ty[i + 1] = ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i + 1] + (width/2) * cos(alpha);
00070             ty[i + ds-&gt;<a class="code" href="structdataset.html#o0">X</a> + 1] = ds-&gt;<a class="code" href="structdataset.html#o3">y</a>[i + 1] + (width/2) * cos(alpha);
00071             tz[i + 1 ] = ds-&gt;<a class="code" href="structdataset.html#o4">z</a>[i + 1];
00072             tz[i + ds-&gt;<a class="code" href="structdataset.html#o0">X</a> + 1] = ds-&gt;<a class="code" href="structdataset.html#o4">z</a>[i + 1];
00073         }
00074     }
00075     
00076     ds-&gt;<a class="code" href="structdataset.html#o2">x</a> = tx;
00077     ds-&gt;<a class="code" href="structdataset.html#o3">y</a> = ty;
00078     ds-&gt;<a class="code" href="structdataset.html#o4">z</a> = tz;
00079     ds-&gt;<a class="code" href="structdataset.html#o1">Y</a> = 2;
00080     
00081     <span class="keywordflow">return</span> ds;
00082 }
00083 
00084 <span class="keyword">struct </span><a class="code" href="structdataset.html">dataset</a> *convertToPara(<span class="keywordtype">char</span> type[5], <span class="keyword">struct</span> <a class="code" href="structdataset.html">dataset</a> *ds)
00085 {
00086     <span class="keywordflow">if</span> (strncmp(type, <span class="stringliteral">""</span>, 4)) {
00087         ds = funcToPara(ds);
00088         printf(<span class="stringliteral">"No type, assumed func\n"</span>);
00089     }
00090     <span class="keywordflow">if</span> (strncmp(type, <span class="stringliteral">"func"</span>, 4)) {
00091         ds = funcToPara(ds);
00092         printf(<span class="stringliteral">"funcToPara\n"</span>);
00093     }
00094     <span class="keywordflow">if</span> (strncmp(type, <span class="stringliteral">"kurv"</span>, 4)) {
00095         ds = kurvToPara(ds);
00096         printf(<span class="stringliteral">"kurvToPara\n"</span>);
00097     }
00098     
00099     <span class="keywordflow">return</span> ds;
00100 }
00101 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon May 3 15:20:15 2004 for 3dplot by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
