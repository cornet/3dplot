<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>3dplot: control.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>control.c</h1><div class="fragment"><pre>00001 
00002 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00003 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00004 <span class="preprocessor">#include &lt;math.h&gt;</span>
00005 
00006 <span class="preprocessor">#if defined(__APPLE__) &amp;&amp; defined(__MACH__)</span>
00007 <span class="preprocessor"></span><span class="preprocessor">#include &lt;GLUT/glut.h&gt;</span>
00008 <span class="preprocessor">#else</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#include &lt;GL/glut.h&gt;</span>
00010 <span class="preprocessor">#endif</span>
00011 <span class="preprocessor"></span>
00012 <span class="preprocessor">#include "<a class="code" href="lights_8h.html">lights.h</a>"</span>
00013 <span class="preprocessor">#include "<a class="code" href="main_8h.html">main.h</a>"</span>
00014 
00015 <span class="preprocessor">#include "<a class="code" href="control_8h.html">control.h</a>"</span>
00016 <span class="preprocessor">#include "<a class="code" href="screenshot_8h.html">screenshot.h</a>"</span>
00017 
00018 <span class="comment">/*</span>
00019 <span class="comment">    Declare external variables</span>
00020 <span class="comment"> */</span>
00021 <span class="keyword">extern</span> <span class="keywordtype">float</span> Camera[3];
00022 <span class="keyword">extern</span> <span class="keywordtype">float</span> Centre[3];
00023 <span class="keyword">extern</span> <span class="keywordtype">float</span> UpVector[3];
00024 <span class="keyword">extern</span> <span class="keywordtype">float</span> Radius;
00025 <span class="keyword">extern</span> <span class="keywordtype">float</span> Theta;
00026 <span class="keyword">extern</span> <span class="keywordtype">float</span> Phi;
00027 
00028 <span class="comment">/*</span>
00029 <span class="comment"> * Declar external flag variables</span>
00030 <span class="comment"> */</span>
00031 <span class="keyword">extern</span> <span class="keywordtype">int</span> OUTPUT;
00032 
00033 <span class="keywordtype">void</span> updateSphericalCoords(<span class="keywordtype">void</span>) 
00034 {
00035     Radius = sqrt(Camera[0]*Camera[0] + Camera[1]*Camera[1] + Camera[2]*Camera[2]);
00036 
00037     <span class="keywordflow">if</span>(Camera[1] == 0.0) {
00038         <span class="keywordflow">if</span>(Camera[0] &gt; 0) { 
00039             Phi = 0.0;
00040         }
00041     } <span class="keywordflow">else</span> {
00042         Phi = atan(Camera[0] / Camera[1]);
00043     }
00044 
00045     <span class="keywordflow">if</span>(Radius == 0.0) {
00046         Theta = 0.0;
00047     } <span class="keywordflow">else</span> {
00048         Theta = acos(Camera[2] / Radius);
00049     }
00050 }
00051 
00052 <span class="keywordtype">void</span> updateCartesianCoords(<span class="keywordtype">void</span>)
00053 {
00054     Camera[0] = Radius * sin(Phi) * sin(Theta);
00055     Camera[2] = Radius * cos(Theta);    
00056     Camera[1] = Radius * cos(Phi) * sin(Theta);
00057 
00058     printf(<span class="stringliteral">"Currnet Speherical Coords: %f %f %f\n"</span>, Radius, Theta, Phi);
00059     printf(<span class="stringliteral">"Updating Cartesian Coords: %f, %f, %f\n"</span>, Camera[0], Camera[1], Camera[2]);
00060 }
00061 
00062 <span class="keywordtype">void</span> updateCamera(<span class="keywordtype">void</span>)
00063 {
00064     glMatrixMode(GL_MODELVIEW);
00065     glLoadIdentity();
00066     gluLookAt(Camera[0], Camera[1], Camera[2],
00067             Centre[0], Centre[1], Centre[2],
00068             UpVector[0], UpVector[1], UpVector[2]);
00069     glutSwapBuffers();
00070     glutPostRedisplay();
00071 }
00072 
00073 <span class="keywordtype">void</span> processNormalKeys(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> key, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)
00074 {
00075     <span class="keyword">extern</span> FILE *Outputfh;
00076     <span class="keywordflow">switch</span> (key) {
00077         <span class="keywordflow">case</span> <span class="charliteral">'q'</span> :
00078             exit(0);
00079             <span class="keywordflow">break</span>;
00080         <span class="keywordflow">case</span> <span class="charliteral">'l'</span>:
00081             addLight(2.0, 2.0, 2.0);
00082             <span class="keywordflow">break</span>;
00083         <span class="keywordflow">case</span> <span class="charliteral">'a'</span> :
00084             moveLight(0, 1.0, 0.0, 0.0, 0.0);
00085             <span class="keywordflow">break</span>;
00086         <span class="keywordflow">case</span> <span class="charliteral">'d'</span> :
00087             moveLight(0, -1.0, 0.0, 0.0, 0.0);
00088             <span class="keywordflow">break</span>; 
00089         <span class="keywordflow">case</span> <span class="charliteral">'w'</span> :
00090             moveLight(0, 0.0, 1.0, 0.0, 0.0);
00091             <span class="keywordflow">break</span>;
00092         <span class="keywordflow">case</span> <span class="charliteral">'s'</span> :
00093             moveLight(0, 0.0, -1.0, 0.0, 0.0);
00094             <span class="keywordflow">break</span>;
00095     }
00096 }
00097 
00098 <span class="keywordtype">void</span> processSpecialKeys(<span class="keywordtype">int</span> key, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)
00099 {
00100     <span class="keywordflow">switch</span> (key) {
00101         <span class="keywordflow">case</span> GLUT_KEY_LEFT :
00102             Phi += 0.1;
00103             updateCartesianCoords();
00104             updateCamera();
00105             <span class="keywordflow">break</span>;
00106         <span class="keywordflow">case</span> GLUT_KEY_RIGHT :
00107             Phi -= 0.1;
00108             updateCartesianCoords();
00109             updateCamera();
00110             <span class="keywordflow">break</span>;
00111         <span class="keywordflow">case</span> GLUT_KEY_UP :
00112             Theta -= 0.1;
00113             <span class="keywordflow">if</span> (Theta &gt; M_PI)
00114                 Theta = M_PI;
00115             <span class="keywordflow">if</span> (Theta &lt; 0)
00116                 Theta = 0;
00117             updateCartesianCoords();
00118             updateCamera();
00119             <span class="keywordflow">break</span>;
00120         <span class="keywordflow">case</span> GLUT_KEY_DOWN :
00121             Theta += 0.1;
00122             <span class="keywordflow">if</span> (Theta &gt; M_PI)
00123                 Theta = M_PI;
00124             <span class="keywordflow">if</span> (Theta &lt; 0)
00125                 Theta = 0;
00126             updateCartesianCoords();
00127             updateCamera();
00128             <span class="keywordflow">break</span>;
00129     }
00130 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon May 3 15:20:15 2004 for 3dplot by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
